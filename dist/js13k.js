function startState(){function t(){circles.push(new Circle(context,100,canvas.width/2,canvas.height/2,0,{r:255,g:0,b:0},8,2e3,300)),setTextWidth(a),setTextWidth(n)}function e(){r+=calculateDeltaTemperature(),Math.abs(r)>i&&(r=r>0?i:-i),r==-i&&switchGameState(INTRO_STATE)}var a={text:"THE KEEPER",font:"45px Sans-serif",color:"#00F"},n={text:"Click the Circle to start",font:"30px Sans-serif",color:"#F0F0F0"},r=0,i=200;return{create:t,update:function(){e(),clearCanvas(),drawCircles(),fillText(a,canvas.width/2-a.width/2,50),drawTemperatureBar(r,i),fillText(n,canvas.width/2-n.width/2,canvas.height-10)},destroy:function(){circles=[]}}}function introState(){function t(){fillText(r,center(r.width,canvas.width),100),fillText(i,center(i.width,canvas.width),210),fillText(c,center(c.width,canvas.width),390)}function e(){fillText(o,center(o.width,canvas.width)-30,100),fillText(l,center(l.width,canvas.width)+30,200),context.fillRect(0,230,canvas.width,5),fillText(s,center(s.width,canvas.width),300),fillText(h,center(h.width,canvas.width),400)}var a=-200,n=200,r={text:"Hi",font:"100px Sans-serif",color:"#313131"},i={text:"keeper",font:"90px Sans-serif",color:"#313131"},c={text:"0015X",font:"95px Sans-serif",color:"#000"},o={text:"Skills",font:"90px Sans-serif",color:"#313131"},l={text:"Tests",font:"90px Sans-serif",color:"#313131"},s={text:"Step 1:",font:"60px Sans-serif",color:"#313131"},h={text:"Cold the room",font:"40px Sans-serif",color:"#313131"},d=0,f=[t,e];return{create:function(){setTextWidth(r),setTextWidth(i),setTextWidth(c),setTextWidth(o),setTextWidth(l),setTextWidth(s),setTextWidth(h)},update:function(){a+=5,a>n&&(a=-n,d+=1,d>=f.length&&switchGameState(LEVEL1_STATE)),clearCanvas(),f[d](),drawTemperatureBar(a,n),drawTemperatureText(a)},destroy:function(){}}}function testState(){var t=70,e=100,a=[-90,10],n=null,r=null,i=0,c=!1;return{create:function(){r=5e3,circles.push(new Circle(context,200,canvas.width/2,canvas.height/2,0,{r:255,g:0,b:0},8,2e3,30))},update:function(){clearCanvas(),drawCircles(),c||(t+=calculateDeltaTemperature()),Math.abs(t)>e&&(t=0>t?-1*e:e),drawMoveableTemperature(t,e),drawTemperatureBar(t,e),drawTemperatureText(t),drawTemperatureRange(a,e),t<=a[1]&&t>=a[0]&&(n=n||setInterval(this.increaseTimeInRange,1e3))},destroy:function(){circles=[]},increaseTimeInRange:function(){i+=1e3,i>=r&&(c=!0)}}}function lerp(t,e,a){return(1-a)*t+a*e}function getRGBText(t){return"rgb("+t.r+","+t.g+","+t.b+")"}function fade(t,e,a,n){var r=100,i=n/r,c=1/i,o=0,l=setInterval(function(){return o>=1?void clearInterval(l):(t.r=Math.round(lerp(e.r,a.r,o)),t.g=Math.round(lerp(e.g,a.g,o)),t.b=Math.round(lerp(e.b,a.b,o)),void(o+=c))},r);return l}function calculateDeltaTemperature(){for(var t=0,e=0;e<circles.length;e++)t+=circles[e].temperatureSpeed;return t}function setTextWidth(t){context.font=t.font,t.width=context.measureText(t.text).width}function fillText(t,e,a){context.fillStyle=t.color,context.font=t.font,context.fillText(t.text,e,a)}function center(t,e){return e/2-t/2}function eventWindowLoaded(){var t=document.getElementById("canvas13K");t.width=window.innerWidth,t.height=window.innerHeight,init()}function init(){canvas=document.getElementById("canvas13K"),canvas&&canvas.getContext&&(context=canvas.getContext("2d"),canvas.addEventListener("click",function(t){onMouseClick(t)},!1),switchGameState(START_STATE),setInterval(function(){stateObj.update()},33))}function switchGameState(t){stateObj&&stateObj.destroy(),stateObj=gameStates[t](),stateObj.create()}function onMouseClick(t){mouseX=t.clientX-canvas.offsetLeft,mouseY=t.clientY-canvas.offsetTop;for(var e=0;e<circles.length;e++)circles[e].checkClick(mouseX,mouseY)}function drawCircles(){for(var t=0;t<circles.length;t++)circles[t].draw()}function clearCanvas(){context.fillStyle="#FFFFFF",context.fillRect(0,0,canvas.width,canvas.height)}function drawTriangle(t,e){context.fillStyle=getRGBText(e),context.lineWidth=2,context.lineCap="square",context.beginPath(),context.moveTo(t-10,canvas.height-60),context.lineTo(t,canvas.height-40),context.lineTo(t+10,canvas.height-60),context.lineTo(t-10,canvas.height-60),context.fill(),context.closePath()}function drawDashedLine(t,e){context.strokeStyle=getRGBText(e),context.lineWidth=2,context.setLineDash([6]),context.beginPath(),context.moveTo(t,canvas.height-40),context.lineTo(t,canvas.height),context.stroke(),context.closePath()}function drawTemperatureRange(t,e){for(var a=t.length-1;a>=0;a--){var n=Math.abs(t[a])*(canvas.width/2)/e;({r:Math.floor(255*t[a]/e),g:0,b:Math.floor(255*t[a]/(-1*e))});n=t[a]<=0?canvas.width/2-n:canvas.width/2+n,drawTriangle(n,{r:31,g:31,b:31}),drawDashedLine(n,{r:255,g:255,b:255})}}function drawMoveableTemperature(t,e){var a=Math.abs(t.toFixed(2))*(canvas.width/2)/e;a=0>=t?canvas.width/2-a:canvas.width/2+a,drawTriangle(a,barColor)}function drawTemperatureBar(t,e){barColor={r:Math.floor(123+t*(123/e)),g:0,b:Math.floor(123-t*(123/e))},context.fillStyle=getRGBText(barColor),context.fillRect(0,canvas.height-40,canvas.width,canvas.height)}function drawTemperatureText(t){context.font="40px Sans-serif",context.fillStyle="#F0F0F0";var e=t.toFixed(2)+"Â°C",a=context.measureText(e);context.fillText(e,canvas.width/2-a.width/2,canvas.height-5)}var Circle=function(t,e,a,n,r,i,c,o,l){var s=2*Math.PI*e,h=s/(o/33),d={x:0,y:0,speed:360/(s/h)*(Math.PI/180)},f=Math.pow(a+(e-(c-c/2))-a,2),u=Math.sqrt(f),x=Math.pow(a+(e+(c-c/2))-a,2),v=Math.sqrt(x),T=null;this.color=i,this.temperatureSpeed=33*l/o,this.draw=function(){t.beginPath(),t.strokeStyle=getRGBText(i),t.lineWidth=c,t.arc(a,n,e,0,2*Math.PI,!0),t.stroke(),t.closePath(),d.x=a+Math.cos(r)*e,d.y=n+Math.sin(r)*e,r+=d.speed,t.fillStyle=getRGBText(i),t.beginPath(),t.arc(d.x,d.y,15,0,2*Math.PI,!0),t.closePath(),t.fill()},this.checkClick=function(t,e){var r=Math.pow(a-t,2),i=Math.pow(n-e,2),c=Math.sqrt(r+i);if(c>=u&&v>=c){clearInterval(T);var o=this.color,l=null;l=d.speed>0?{r:0,g:0,b:255}:{r:255,g:0,b:0},T=fade(this.color,o,l,2e3),d.speed*=-1,this.temperatureSpeed*=-1}},this.drawDebug=function(){t.fillStyle="blue",t.beginPath(),t.arc(a,n,1,0,2*Math.PI,!0),t.closePath(),t.fill(),t.fillStyle="blue",t.beginPath(),t.arc(a+e+(c-c/2),n,1,0,2*Math.PI,!0),t.arc(a+e-(c-c/2),n,1,0,2*Math.PI,!0),t.closePath(),t.fill()}};window.addEventListener("load",eventWindowLoaded,!1);var START_STATE=0,LEVEL1_STATE=1,INTRO_STATE=2,canvas=null,context=null,circles=[],mouseX=null,mouseY=null,currentGameState=0,currentGameStateFunction=null,barColor={r:255,g:255,b:255},stateObj=null,gameStates=[startState,testState,introState];