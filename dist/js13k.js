function startState(){return{create:function(){circles.push(new Circle(context,50,canvas.width/2,canvas.height/2,0,{r:255,g:0,b:0},8,2e3,10))},update:function(){clearCanvas(),drawCircles()},destroy:function(){circles=[]}}}function lerp(t,e,a){return(1-a)*t+a*e}function fade(t,e,a,n){var r=10,c=n/r,i=1/c,l=0,o=setInterval(function(){l>=1&&clearInterval(o);var n=Math.round(lerp(e.r,a.r,l)),r=Math.round(lerp(e.g,a.g,l)),c=Math.round(lerp(e.b,a.b,l));t.color={r:n,g:r,b:c},l+=i},r);return o}function getRGBText(t){return"rgb("+t.r+","+t.g+","+t.b+")"}function eventWindowLoaded(){var t=document.getElementById("canvas13K");t.width=window.innerWidth,t.height=window.innerHeight,init()}function init(){canvas=document.getElementById("canvas13K"),canvas&&canvas.getContext&&(context=canvas.getContext("2d"),canvas.addEventListener("click",function(t){onMouseClick(t)},!1),switchGameState(START_STATE),setInterval(function(){stateObj.update()},33))}function switchGameState(t){stateObj&&stateObj.destroy(),stateObj=gameStates[t](),stateObj.create()}function onMouseClick(t){mouseX=t.clientX-canvas.offsetLeft,mouseY=t.clientY-canvas.offsetTop;for(var e=0;e<circles.length;e++)circles[e].checkClick(mouseX,mouseY)}function drawCircles(){for(var t=0;t<circles.length;t++)circles[t].draw()}function drawTemperatureIndicator(){context.fillStyle=getRGBText(barColor),context.fillRect(0,canvas.height-40,canvas.width,canvas.height),context.font="40px Sans-serif",context.fillStyle="#F0F0F0";var t=temperature.toFixed(2)+"Â°C",e=context.measureText(t);context.fillText(t,canvas.width/2-e.width/2,canvas.height-5)}function clearCanvas(){context.fillStyle="#FFFFFF",context.fillRect(0,0,canvas.width,canvas.height)}var Circle=function(t,e,a,n,r,c,i,l,o){var t=t,e=e,a=a,n=n,i=i,r=r,c=c,l=l,o=o,s=33*o/l,u=2*Math.PI*e,h=u/(l/33),d={x:0,y:0,speed:360/(u/h)*(Math.PI/180)},f=Math.pow(a+(e-(i-i/2))-a,2),v=Math.sqrt(f),g=Math.pow(a+(e+(i-i/2))-a,2),m=Math.sqrt(g),p=null;this.draw=function(){t.beginPath(),t.strokeStyle=getRGBText(c),t.lineWidth=i,t.arc(a,n,e,0,2*Math.PI,!0),t.stroke(),t.closePath(),d.x=a+Math.cos(r)*e,d.y=n+Math.sin(r)*e,r+=d.speed,t.fillStyle=getRGBText(c),t.beginPath(),t.arc(d.x,d.y,15,0,2*Math.PI,!0),t.closePath(),t.fill(),temperature+=s,temperature>maxTemperature||(barColor={r:Math.floor(255*temperature/maxTemperature),g:0,b:Math.floor(255*temperature/(-1*maxTemperature))})},this.checkClick=function(t,e){var r=Math.pow(a-t,2),i=Math.pow(n-e,2),l=Math.sqrt(r+i);if(l>=v&&m>=l){clearInterval(p);var o=c,u=null;u=d.speed>0?{r:0,g:0,b:255}:{r:255,g:0,b:0},p=fade(o,u,2e3),d.speed*=-1,s*=-1}},this.drawDebug=function(){t.fillStyle="blue",t.beginPath(),t.arc(a,n,1,0,2*Math.PI,!0),t.closePath(),t.fill(),t.fillStyle="blue",t.beginPath(),t.arc(a+e+(i-i/2),n,1,0,2*Math.PI,!0),t.arc(a+e-(i-i/2),n,1,0,2*Math.PI,!0),t.closePath(),t.fill()}};window.addEventListener("load",eventWindowLoaded,!1);var START_STATE=0,TEST_STATE=1,canvas=null,context=null,circles=[],mouseX=null,mouseY=null,currentGameState=0,currentGameStateFunction=null,temperature=0,maxTemperature=100,barColor={r:255,g:255,b:255},stateObj=null,gameStates=[startState];